schema: |
  
  definition user {}

  caveat has_resource_verb(requested_resource_verb string, allowed_resource_verbs list<string>) {
    requested_resource_verb in allowed_resource_verbs
  }

  // namespaces
  definition namespace {
      relation verb: user | user with has_resource_verb
  }
relationships: |
  // Some example relationships
  namespace:ns1#verb@user:user1[has_resource_verb:{"allowed_resource_verbs":["get_vm","get_pod"]}]
assertions:
  assertTrue:
    - namespace:ns1#verb@user:user1 with {"requested_resource_verb":"get_vm"}
    - namespace:ns1#verb@user:user1 with {"requested_resource_verb":"get_pod"}
  assertFalse:
    - namespace:ns1#verb@user:user1 with {"requested_resource_verb":"madeup"}
validation: null
