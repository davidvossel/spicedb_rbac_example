schema: |
  
  definition user {}

  caveat has_namespaced_permission(requested_resource string, allowed_resources list<string>) {
    requested_resource in allowed_resources
  }

  definition namespace {
      relation getter: user | user with has_namespaced_permission
      permission get = getter
  }
relationships: |
  namespace:ns1#getter@user:user1[has_namespaced_permission:{"allowed_resources":["vm","pod"]}]
assertions:
  assertTrue:
    - namespace:ns1#getter@user:user1 with {"requested_resource":"vm"}
    - namespace:ns1#getter@user:user1 with {"requested_resource":"pod"}
  assertFalse:
    - namespace:ns1#getter@user:user1 with {"requested_resource":"madeup"}
validation: null
